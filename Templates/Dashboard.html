{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Easy Share</title>
    <link rel="shortcut icon" href="{% static 'Logo.png' %}" type="image/x-icon">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&family=Kaushan+Script&family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f7ff', 100: '#e0edff', 200: '#b3d4ff', 300: '#80b8ff',
                            400: '#4d9bff', 500: '#1a80ff', 600: '#1466cc', 700: '#0f4d99',
                            800: '#0a3366', 900: '#072033'
                        },
                        secondary: {
                            50: '#f0faff', 100: '#e0f3ff', 200: '#b3e1ff', 300: '#80cbff',
                            400: '#4db4ff', 500: '#1a9cff', 600: '#147ccc', 700: '#0f5f99',
                            800: '#0a4266', 900: '#073233'
                        },
                        accent: {
                            50: '#f2f6ff', 100: '#e6edff', 200: '#c7d6ff', 300: '#a3bcff',
                            400: '#7a9cff', 500: '#517cff', 600: '#4163cc', 700: '#314a99',
                            800: '#213266', 900: '#152033'
                        },
                        neutral: {
                            50: '#fafafa', 100: '#f5f5f5', 200: '#e5e5e5', 300: '#d4d4d4',
                            400: '#a3a3a3', 500: '#737373', 600: '#525252', 700: '#404040',
                            800: '#262626', 900: '#171717'
                        }
                    },
                    fontFamily: {
                        'sans': ['Space Grotesk', 'system-ui', 'sans-serif'],
                        'script': ['Dancing Script', 'cursive'],
                        'display': ['Kaushan Script', 'cursive'],
                        'mono': ['JetBrains Mono', 'monospace']
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.8s ease-out',
                        'slide-up': 'slideUp 0.6s ease-out',
                        'scale-in': 'scaleIn 0.5s ease-out',
                        'float': 'float 3s ease-in-out infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'toast-slide': 'toastSlide 0.5s ease-out forwards',
                        'border-fire': 'borderFire 2s linear infinite',
                        'pulse-slow': 'pulse 3s ease-in-out infinite',
                        'bounce-slow': 'bounce 3s ease-in-out infinite'
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(30px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        },
                        scaleIn: {
                            '0%': { transform: 'scale(0.9)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' }
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-10px)' }
                        },
                        glow: {
                            '0%': { boxShadow: '0 0 20px rgba(26, 128, 255, 0.3)' },
                            '100%': { boxShadow: '0 0 30px rgba(26, 128, 255, 0.6)' }
                        },
                        toastSlide: {
                            '0%': { transform: 'translateX(100%)' },
                            '100%': { transform: 'translateX(0)' }
                        },
                        borderFire: {
                            '0%': { backgroundPosition: '0% 0%' },
                            '100%': { backgroundPosition: '200% 0%' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #F1F5F9 0%, #E0E7FF 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        .pl {
            width: 6em;
            height: 6em;
        }

        .pl__ring {
            animation: ringA 2s linear infinite;
        }

        .pl__ring--a { stroke: #1a80ff; }
        .pl__ring--b { animation-name: ringB; stroke: #4d9bff; }
        .pl__ring--c { animation-name: ringC; stroke: #80b8ff; }
        .pl__ring--d { animation-name: ringD; stroke: #b3e1ff; }

        @keyframes ringA {
            from, 4% { stroke-dasharray: 0 660; stroke-width: 20; stroke-dashoffset: -330; }
            12% { stroke-dasharray: 60 600; stroke-width: 30; stroke-dashoffset: -335; }
            32% { stroke-dasharray: 60 600; stroke-width: 30; stroke-dashoffset: -595; }
            40%, 54% { stroke-dasharray: 0 660; stroke-width: 20; stroke-dashoffset: -660; }
            62% { stroke-dasharray: 60 600; stroke-width: 30; stroke-dashoffset: -665; }
            82% { stroke-dasharray: 60 600; stroke-width: 30; stroke-dashoffset: -925; }
            90%, to { stroke-dasharray: 0 660; stroke-width: 20; stroke-dashoffset: -990; }
        }

        @keyframes ringB {
            from, 12% { stroke-dasharray: 0 220; stroke-width: 20; stroke-dashoffset: -110; }
            20% { stroke-dasharray: 20 200; stroke-width: 30; stroke-dashoffset: -115; }
            40% { stroke-dasharray: 20 200; stroke-width: 30; stroke-dashoffset: -195; }
            48%, 62% { stroke-dasharray: 0 220; stroke-width: 20; stroke-dashoffset: -220; }
            70% { stroke-dasharray: 20 200; stroke-width: 30; stroke-dashoffset: -225; }
            90% { stroke-dasharray: 20 200; stroke-width: 30; stroke-dashoffset: -305; }
            98%, to { stroke-dasharray: 0 220; stroke-width: 20; stroke-dashoffset: -330; }
        }

        @keyframes ringC {
            from { stroke-dasharray: 0 440; stroke-width: 20; stroke-dashoffset: 0; }
            8% { stroke-dasharray: 40 400; stroke-width: 30; stroke-dashoffset: -5; }
            28% { stroke-dasharray: 40 400; stroke-width: 30; stroke-dashoffset: -175; }
            36%, 58% { stroke-dasharray: 0 440; stroke-width: 20; stroke-dashoffset: -220; }
            66% { stroke-dasharray: 40 400; stroke-width: 30; stroke-dashoffset: -225; }
            86% { stroke-dasharray: 40 400; stroke-width: 30; stroke-dashoffset: -395; }
            94%, to { stroke-dasharray: 0 440; stroke-width: 20; stroke-dashoffset: -440; }
        }

        @keyframes ringD {
            from, 8% { stroke-dasharray: 0 440; stroke-width: 20; stroke-dashoffset: 0; }
            16% { stroke-dasharray: 40 400; stroke-width: 30; stroke-dashoffset: -5; }
            36% { stroke-dasharray: 40 400; stroke-width: 30; stroke-dashoffset: -175; }
            44%, 50% { stroke-dasharray: 0 440; stroke-width: 20; stroke-dashoffset: -220; }
            58% { stroke-dasharray: 40 400; stroke-width: 30; stroke-dashoffset: -225; }
            78% { stroke-dasharray: 40 400; stroke-width: 30; stroke-dashoffset: -395; }
            86%, to { stroke-dasharray: 0 440; stroke-width: 20; stroke-dashoffset: -440; }
        }

        .nav-blur {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(26, 128, 255, 0.1);
            box-shadow: 0 4px 20px rgba(26, 128, 255, 0.1);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(26, 128, 255, 0.1), 0 4px 16px rgba(26, 156, 255, 0.05), inset 0 1px 0 rgba(255, 255, 255, 0.5);
        }

        .text-gradient {
            background: linear-gradient(135deg, #1a80ff, #1466cc, #1a9cff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .pattern-bg {
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(26, 128, 255, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(26, 156, 255, 0.05) 0%, transparent 50%);
        }

        body {
            background: linear-gradient(135deg, #f0f7ff 0%, #f0faff 25%, #f2f6ff 50%, #f0f7ff 75%, #f0faff 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        * {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="8" fill="%231a80ff" fill-opacity="0.3"/><circle cx="12" cy="12" r="3" fill="%231a80ff"/></svg>'), auto;
        }

        a, button, .cursor-pointer {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="8" fill="%231466cc" fill-opacity="0.4"/><circle cx="12" cy="12" r="4" fill="%231466cc"/></svg>'), pointer;
        }

        * {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Enhanced Sidebar Styles */
        .sidebar {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.98) 0%, rgba(240, 247, 255, 0.95) 100%);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(26, 128, 255, 0.1);
            box-shadow: 4px 0 20px rgba(26, 128, 255, 0.05);
            position: relative;
            overflow: hidden;
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #1a80ff, #1466cc, #1a9cff, #1a80ff);
            background-size: 200% 100%;
            animation: gradientShift 3s ease infinite;
        }

        .sidebar-nav {
            position: relative;
            z-index: 2;
        }

        .sidebar-item {
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sidebar-item:hover {
            transform: translateX(8px);
            box-shadow: 0 8px 25px rgba(26, 128, 255, 0.15);
        }

        .sidebar-item.active {
            background: linear-gradient(135deg, rgba(26, 128, 255, 0.1) 0%, rgba(26, 156, 255, 0.05) 100%);
            border-left: 4px solid #1a80ff;
            transform: translateX(4px);
            box-shadow: 0 4px 15px rgba(26, 128, 255, 0.1);
        }

        .sidebar-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(26, 128, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .sidebar-item:hover::before {
            left: 100%;
        }

        .sidebar-icon {
            transition: all 0.3s ease;
        }

        .sidebar-item:hover .sidebar-icon {
            transform: scale(1.2) rotate(5deg);
        }

        .sidebar-item.active .sidebar-icon {
            color: #1a80ff;
            transform: scale(1.1);
            text-shadow: 0 0 10px rgba(26, 128, 255, 0.3);
        }

        .sidebar-text {
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .sidebar-item:hover .sidebar-text {
            font-weight: 600;
        }

        .table-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(26, 128, 255, 0.1), 0 4px 16px rgba(26, 156, 255, 0.05);
            border: 1px solid rgba(26, 128, 255, 0.1);
        }

        .modal-backdrop {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }

        .upload-area {
            border: 2px dashed #1a80ff;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #1466cc;
            background: rgba(26, 128, 255, 0.05);
        }

        .file-item {
            background: rgba(26, 128, 255, 0.1);
            border-radius: 10px;
            padding: 10px;
            margin: 5px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Table Enhancement */
        .table-header-icon {
            transition: all 0.3s ease;
        }

        .table-header:hover .table-header-icon {
            transform: rotate(360deg);
            color: #1a80ff;
        }

        .file-icon {
            transition: all 0.3s ease;
        }

        .file-row:hover .file-icon {
            transform: scale(1.1);
        }

        .file-row {
            transition: all 0.3s ease;
        }

        .file-row:hover {
            transform: translateY(-2px);
            background: linear-gradient(90deg, rgba(26, 128, 255, 0.05), rgba(26, 156, 255, 0.05));
            box-shadow: 0 4px 15px rgba(26, 128, 255, 0.1);
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: linear-gradient(180deg, #f0f7ff 0%, #f0faff 50%, #f2f6ff 100%);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #1a80ff, #1466cc);
            border-radius: 10px;
            border: 2px solid #f0f7ff;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #1466cc, #0f4d99);
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(90deg, #1a80ff, #1466cc);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            z-index: 10000;
            display: flex;
            align-items: center;
            animation: toast-slide 0.5s ease-out;
            border-bottom: 4px solid;
            border-image: linear-gradient(90deg, #ff6b6b, #ffe066, #00ffcc, #ff6b6b) 1;
            animation: border-fire 2s linear infinite;
        }

        .toast-success { background: linear-gradient(90deg, #22c55e, #16a34a); }
        .toast-error { background: linear-gradient(90deg, #ef4444, #dc2626); }
        .upload-preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10001;
            display: none;
        }

        /* Floating Animation Elements */
        .floating-orb {
            position: absolute;
            border-radius: 50%;
            opacity: 0.6;
            pointer-events: none;
            animation: float 8s ease-in-out infinite;
        }

        .floating-orb:nth-child(1) {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, rgba(26, 128, 255, 0.3), transparent);
            top: 20%;
            right: 10%;
            animation-delay: 0s;
        }

        .floating-orb:nth-child(2) {
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, rgba(26, 156, 255, 0.2), transparent);
            bottom: 30%;
            right: 15%;
            animation-delay: -3s;
        }

        .floating-orb:nth-child(3) {
            width: 40px;
            height: 40px;
            background: radial-gradient(circle, rgba(81, 124, 255, 0.4), transparent);
            top: 60%;
            right: 5%;
            animation-delay: -6s;
        }
    </style>
</head>
<body class="font-sans text-neutral-800 pattern-bg">
    <!-- Page Preloader -->
    <div class="preloader" id="preloader">
        <svg class="pl" width="240" height="240" viewBox="0 0 240 240">
            <circle class="pl__ring pl__ring--a" cx="120" cy="120" r="105" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 660" stroke-dashoffset="-330" stroke-linecap="round"></circle>
            <circle class="pl__ring pl__ring--b" cx="120" cy="120" r="35" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 220" stroke-dashoffset="-110" stroke-linecap="round"></circle>
            <circle class="pl__ring pl__ring--c" cx="85" cy="120" r="70" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 440" stroke-linecap="round"></circle>
            <circle class="pl__ring pl__ring--d" cx="155" cy="120" r="70" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 440" stroke-linecap="round"></circle>
        </svg>
    </div>

    <!-- Upload Preloader -->
    <div class="upload-preloader" id="uploadPreloader">
        <svg class="pl" width="240" height="240" viewBox="0 0 240 240">
            <circle class="pl__ring pl__ring--a" cx="120" cy="120" r="105" fill="none" stroke="#1a80ff" stroke-width="20" stroke-dasharray="0 660" stroke-dashoffset="-330" stroke-linecap="round"></circle>
            <circle class="pl__ring pl__ring--b" cx="120" cy="120" r="35" fill="none" stroke="#4d9bff" stroke-width="20" stroke-dasharray="0 220" stroke-dashoffset="-110" stroke-linecap="round"></circle>
            <circle class="pl__ring pl__ring--c" cx="85" cy="120" r="70" fill="none" stroke="#80b8ff" stroke-width="20" stroke-dasharray="0 440" stroke-linecap="round"></circle>
            <circle class="pl__ring pl__ring--d" cx="155" cy="120" r="70" fill="none" stroke="#b3e1ff" stroke-width="20" stroke-dasharray="0 440" stroke-linecap="round"></circle>
        </svg>
    </div>

    <!-- Top Navigation -->
    <nav class="fixed top-0 w-full z-40 nav-blur">
        <div class="px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <div class="flex items-center space-x-3">
                    <img src="{% static 'Logo.png' %}" alt="Easy Share" class="h-12 transition-transform group-hover:scale-110 animate-glow">
                    <span class="text-2xl font-bold text-gradient">Easy Share</span>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-3">
                        <span class="text-neutral-700 font-medium">Pioneer Software Solutions Pvt. Ltd.</span>
                        <div class="w-10 h-10 bg-gradient-to-br from-primary-400 to-primary-600 rounded-full flex items-center justify-center">
                            <img src="https://pioneersoftware.com.np/img/MainLogo.png" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="flex pt-20">
        <!-- Enhanced Left Sidebar -->
        <div class="fixed left-0 top-20 h-screen w-64 sidebar z-30">
            <!-- Floating Orbs -->
            <div class="floating-orb"></div>
            <div class="floating-orb"></div>
            <div class="floating-orb"></div>
            
            <div class="p-6 sidebar-nav">
                <nav class="space-y-4">
                    <a href="#" class="sidebar-item active flex items-center space-x-3 px-4 py-4 rounded-xl font-medium transition-all duration-300">
                        <i class="fas fa-tachometer-alt sidebar-icon text-lg"></i>
                        <span class="sidebar-text">Dashboard</span>
                    </a>
                    <a href="{% url 'logout_view' %}" class="sidebar-item flex items-center space-x-3 px-4 py-4 text-neutral-600 hover:text-red-600 rounded-xl font-medium w-full text-left transition-all duration-300">
                        <i class="fas fa-sign-out-alt sidebar-icon text-lg"></i>
                        <span class="sidebar-text">Logout</span>
                    </a>                
                </nav>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 ml-64 p-6">
            <div class="max-w-7xl mx-auto">
                <!-- Table Container -->
                <div class="table-container p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-semibold text-gradient flex items-center">
                            <i class="fas fa-folder-open mr-3 text-primary-500"></i>
                            File Management
                        </h2>
                        <button onclick="openModal()" class="bg-gradient-to-r from-primary-500 to-primary-600 text-white px-6 py-3 rounded-full font-semibold hover:from-primary-600 hover:to-primary-700 transition-all duration-300 transform hover:scale-105 shadow-lg animate-glow">
                            <i class="fas fa-upload mr-2"></i>
                            Upload File
                        </button>
                    </div>

                    <!-- Enhanced Table -->
                    <div class="overflow-x-auto rounded-xl">
                        <table class="w-full">
                            <thead>
                                <tr class="bg-gradient-to-r from-primary-50 to-secondary-50 border-b-2 border-primary-200">
                                    <th class="text-left py-4 px-4 font-semibold text-neutral-700 table-header">
                                        <div class="flex items-center space-x-2">
                                            <i class="fas fa-hashtag table-header-icon"></i>
                                            <span>SN</span>
                                        </div>
                                    </th>
                                    <th class="text-left py-4 px-4 font-semibold text-neutral-700 table-header">
                                        <div class="flex items-center space-x-2">
                                            <i class="fas fa-file-alt table-header-icon"></i>
                                            <span>File Details</span>
                                        </div>
                                    </th>
                                    <th class="text-left py-4 px-4 font-semibold text-neutral-700 table-header">
                                        <div class="flex items-center space-x-2">
                                            <i class="fas fa-calendar-alt table-header-icon"></i>
                                            <span>Uploaded At</span>
                                        </div>
                                    </th>
                                    <th class="text-left py-4 px-4 font-semibold text-neutral-700 table-header">
                                        <div class="flex items-center space-x-2">
                                            <i class="fas fa-cogs table-header-icon"></i>
                                            <span>Actions</span>
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="fileTable">
                                {% if files %}
                                    {% for file in files %}
                                        <tr class="file-row border-b border-neutral-100 hover:bg-neutral-50 rounded-lg" data-id="{{ file.id }}" data-filename="{{ file.file.name|cut:'uploads/' }}">
                                            <td class="py-4 px-4">
                                                <span class="inline-flex items-center justify-center w-8 h-8 bg-primary-100 text-primary-600 rounded-full font-semibold">{{ forloop.counter }}</span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <div class="flex items-center space-x-3">
                                                    <i class="file-icon text-2xl fas fa-file text-gray-400"></i>
                                                    <div>
                                                        <div class="font-medium text-gray-900">{{ file.file.name|cut:"uploads/" }}</div>
                                                        <div class="text-sm text-gray-500 file-description">File</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="py-4 px-4">
                                                <div class="flex items-center space-x-2 text-gray-600">
                                                    <i class="fas fa-clock text-sm text-primary-500"></i>
                                                    <span>{{ file.uploaded_at|date:"Y-m-d H:i A" }}</span>
                                                </div>
                                            </td>
                                            <td class="py-4 px-4">
                                                <div class="flex space-x-2">                                                   
                                                    <button onclick="deleteFile({{ file.id }})" class="text-red-600 hover:text-red-700 p-2 rounded-full hover:bg-red-50 transition-all duration-300 transform hover:scale-110">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr>
                                        <td colspan="4" class="py-12 text-center text-neutral-500">
                                            <div class="flex flex-col items-center">
                                                <i class="fas fa-folder-open text-6xl mb-4 text-primary-200"></i>
                                                <h3 class="text-xl font-medium text-gray-700 mb-2">No files uploaded yet</h3>
                                                <p class="text-gray-500">Upload your first file to get started</p>
                                            </div>
                                        </td>
                                    </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Upload Modal -->
    <div id="uploadModal" class="fixed inset-0 z-50 hidden">
        <div class="modal-backdrop absolute inset-0" onclick="closeModal()"></div>
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="glass-card rounded-3xl p-8 max-w-md w-full mx-auto animate-scale-in">
                <div class="text-center mb-6">
                    <h3 class="text-2xl font-bold text-gradient mb-2" id="modalTitle">Upload File</h3>
                    <p class="text-neutral-600">Choose a file to upload</p>
                </div>

                <div class="upload-area p-8 text-center rounded-2xl mb-6 cursor-pointer" onclick="document.getElementById('fileInput').click()">
                    <div class="text-6xl text-primary-500 mb-4">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <p class="text-neutral-600 mb-2">Click to upload or drag and drop</p>
                    <p class="text-sm text-neutral-500">Any file type supported</p>
                </div>

                <input type="file" id="fileInput" class="hidden" onchange="handleFileSelect()" multiple accept="*/*">

                <div id="fileList" class="mb-6 max-h-32 overflow-y-auto"></div>

                <div class="flex space-x-4">
                    <button onclick="closeModal()" class="flex-1 px-6 py-3 bg-neutral-200 text-neutral-700 rounded-full font-semibold hover:bg-neutral-300 transition-colors">
                        Cancel
                    </button>
                    <button onclick="uploadFiles()" id="actionButton" class="flex-1 bg-gradient-to-r from-primary-500 to-primary-600 text-white px-6 py-3 rounded-full font-semibold hover:from-primary-600 hover:to-primary-700 transition-all duration-300 transform hover:scale-105">
                        Upload
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let selectedFiles = [];
        let editFileId = null;

        // File icon detection functions
        function getFileIcon(filename) {
            if (!filename) return 'fas fa-file text-gray-400';
            
            const extension = filename.split('.').pop().toLowerCase();
            const iconMap = {
                'exe': 'fas fa-file-code text-blue-500',
                'msi': 'fas fa-file-code text-blue-600',
                'bat': 'fas fa-file-code text-blue-500',
                'cmd': 'fas fa-file-code text-blue-500',
                'pdf': 'fas fa-file-pdf text-red-500',
                'doc': 'fas fa-file-word text-blue-700',
                'docx': 'fas fa-file-word text-blue-700',
                'xls': 'fas fa-file-excel text-green-600',
                'xlsx': 'fas fa-file-excel text-green-600',
                'ppt': 'fas fa-file-powerpoint text-orange-600',
                'pptx': 'fas fa-file-powerpoint text-orange-600',
                'zip': 'fas fa-file-archive text-yellow-600',
                'rar': 'fas fa-file-archive text-yellow-600',
                '7z': 'fas fa-file-archive text-yellow-600',
                'tar': 'fas fa-file-archive text-yellow-600',
                'gz': 'fas fa-file-archive text-yellow-600',
                'png': 'fas fa-file-image text-green-500',
                'jpg': 'fas fa-file-image text-green-500',
                'jpeg': 'fas fa-file-image text-green-500',
                'gif': 'fas fa-file-image text-green-500',
                'bmp': 'fas fa-file-image text-green-500',
                'svg': 'fas fa-file-image text-green-500',
                'mp4': 'fas fa-file-video text-purple-500',
                'avi': 'fas fa-file-video text-purple-500',
                'mov': 'fas fa-file-video text-purple-500',
                'wmv': 'fas fa-file-video text-purple-500',
                'mkv': 'fas fa-file-video text-purple-500',
                'mp3': 'fas fa-file-audio text-pink-500',
                'wav': 'fas fa-file-audio text-pink-500',
                'flac': 'fas fa-file-audio text-pink-500',
                'aac': 'fas fa-file-audio text-pink-500',
                'txt': 'fas fa-file-alt text-gray-500',
                'rtf': 'fas fa-file-alt text-gray-500',
                'html': 'fas fa-file-code text-orange-500',
                'htm': 'fas fa-file-code text-orange-500',
                'css': 'fas fa-file-code text-blue-400',
                'js': 'fas fa-file-code text-yellow-500',
                'php': 'fas fa-file-code text-purple-600',
                'py': 'fas fa-file-code text-blue-500',
                'java': 'fas fa-file-code text-red-600',
                'cpp': 'fas fa-file-code text-blue-600',
                'c': 'fas fa-file-code text-blue-600',
                'sql': 'fas fa-database text-indigo-500',
                'json': 'fas fa-file-code text-green-600',
                'xml': 'fas fa-file-code text-orange-400',
            };
            
            return iconMap[extension] || 'fas fa-file text-gray-400';
        }

        function getFileDescription(filename) {
            if (!filename) return 'File';
            
            const extension = filename.split('.').pop().toLowerCase();
            const descriptionMap = {
                'exe': 'Executable file',
                'msi': 'Installer package',
                'bat': 'Batch file',
                'cmd': 'Command file',
                'pdf': 'PDF document',
                'doc': 'Word document',
                'docx': 'Word document',
                'xls': 'Excel spreadsheet',
                'xlsx': 'Excel spreadsheet',
                'ppt': 'PowerPoint presentation',
                'pptx': 'PowerPoint presentation',
                'zip': 'Archive file',
                'rar': 'Archive file',
                '7z': 'Archive file',
                'tar': 'Archive file',
                'gz': 'Compressed file',
                'png': 'Image file',
                'jpg': 'Image file',
                'jpeg': 'Image file',
                'gif': 'Animated image',
                'bmp': 'Image file',
                'svg': 'Vector image',
                'mp4': 'Video file',
                'avi': 'Video file',
                'mov': 'Video file',
                'wmv': 'Video file',
                'mkv': 'Video file',
                'mp3': 'Audio file',
                'wav': 'Audio file',
                'flac': 'Audio file',
                'aac': 'Audio file',
                'txt': 'Text file',
                'rtf': 'Rich text file',
                'html': 'Web page',
                'htm': 'Web page',
                'css': 'Stylesheet',
                'js': 'JavaScript file',
                'php': 'PHP script',
                'py': 'Python script',
                'java': 'Java source',
                'cpp': 'C++ source',
                'c': 'C source',
                'sql': 'Database file',
                'json': 'JSON data',
                'xml': 'XML file',
            };
            
            return descriptionMap[extension] || 'File';
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Initialize file icons and descriptions
            document.querySelectorAll('.file-row').forEach(row => {
                const filename = row.dataset.filename;
                const fileIcon = row.querySelector('.file-icon');
                const fileDescription = row.querySelector('.file-description');
                
                if (filename && fileIcon && fileDescription) {
                    // Update icon
                    fileIcon.className = `file-icon text-2xl ${getFileIcon(filename)}`;
                    // Update description
                    fileDescription.textContent = getFileDescription(filename);
                }
            });

            // Preloader
            const preloader = document.getElementById('preloader');
            setTimeout(function() {
                preloader.style.opacity = '0';
                setTimeout(function() {
                    preloader.style.display = 'none';
                }, 500);
            }, 1500);
        });

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'} mr-2"></i>
                ${message}
            `;
            document.body.appendChild(toast);
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function openModal() {
            document.getElementById('uploadModal').classList.remove('hidden');
            document.getElementById('modalTitle').textContent = 'Upload File';
            document.getElementById('actionButton').textContent = 'Upload';
            editFileId = null;
            selectedFiles = [];
            document.getElementById('fileList').innerHTML = '';
            document.getElementById('fileInput').value = '';
        }

        function openEditModal(fileId) {
            document.getElementById('uploadModal').classList.remove('hidden');
            document.getElementById('modalTitle').textContent = 'Update File';
            document.getElementById('actionButton').textContent = 'Update';
            editFileId = fileId;
            selectedFiles = [];
            document.getElementById('fileList').innerHTML = '';
            document.getElementById('fileInput').value = '';
        }

        function closeModal() {
            document.getElementById('uploadModal').classList.add('hidden');
        }

        function handleFileSelect() {
            const fileInput = document.getElementById('fileInput');
            selectedFiles = Array.from(fileInput.files);
            displaySelectedFiles();
        }

        function displaySelectedFiles() {
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '';
            
            selectedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item flex justify-between items-center';
                const iconClass = getFileIcon(file.name);
                fileItem.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <i class="${iconClass}"></i>
                        <div>
                            <div class="font-medium text-sm">${file.name}</div>
                            <div class="text-xs text-neutral-500">${(file.size / 1024 / 1024).toFixed(2)} MB</div>
                        </div>
                    </div>
                    <button onclick="removeFile(${index})" class="text-red-500 hover:text-red-700 p-1 transition-colors">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                fileList.appendChild(fileItem);
            });
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            displaySelectedFiles();
        }

        function uploadFiles() {
            if (selectedFiles.length === 0) {
                showToast('Please select files to upload', 'error');
                return;
            }

            const uploadPreloader = document.getElementById('uploadPreloader');
            uploadPreloader.style.display = 'flex';

            const formData = new FormData();
            if (editFileId) {
                formData.append('id', editFileId);
                formData.append('file', selectedFiles[0]);
                fetch('', {
                    method: 'PUT',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    uploadPreloader.style.display = 'none';
                    if (data.status === 'success') {
                        showToast(data.message);
                        updateFileRow(data);
                        closeModal();
                    } else {
                        showToast(data.message, 'error');
                    }
                })
                .catch(error => {
                    uploadPreloader.style.display = 'none';
                    showToast('Error updating file', 'error');
                });
            } else {
                selectedFiles.forEach(file => formData.append('file', file));
                fetch('', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    uploadPreloader.style.display = 'none';
                    if (data.status === 'success') {
                        showToast(data.message);
                        window.location.reload(); // Refresh to show new files
                        closeModal();
                    } else {
                        showToast(data.message, 'error');
                    }
                })
                .catch(error => {
                    uploadPreloader.style.display = 'none';
                    showToast('Error uploading files', 'error');
                });
            }
        }

        function updateFileRow(data) {
            const row = document.querySelector(`tr[data-id="${editFileId}"]`);
            if (row) {
                // Update row with new file info (server should return new file data)
                // For simplicity, reload the page
                window.location.reload();
            }
        }

        function deleteFile(fileId) {
            if (confirm('Are you sure you want to delete this file?')) {
                const uploadPreloader = document.getElementById('uploadPreloader');
                uploadPreloader.style.display = 'flex';

                fetch('', {
                    method: 'DELETE',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ id: fileId })
                })
                .then(response => response.json())
                .then(data => {
                    uploadPreloader.style.display = 'none';
                    if (data.status === 'success') {
                        showToast(data.message);
                        const row = document.querySelector(`tr[data-id="${fileId}"]`);
                        if (row) row.remove();
                        if (!document.querySelector('#fileTable tr[data-id]')) {
                            document.getElementById('fileTable').innerHTML = `
                                <tr>
                                    <td colspan="4" class="py-12 text-center text-neutral-500">
                                        <div class="flex flex-col items-center">
                                            <i class="fas fa-folder-open text-6xl mb-4 text-primary-200"></i>
                                            <h3 class="text-xl font-medium text-gray-700 mb-2">No files uploaded yet</h3>
                                            <p class="text-gray-500">Upload your first file to get started</p>
                                        </div>
                                    </td>
                                </tr>
                            `;
                        }
                    } else {
                        showToast(data.message, 'error');
                    }
                })
                .catch(error => {
                    uploadPreloader.style.display = 'none';
                    showToast('Error deleting file', 'error');
                });
            }
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                alert('Logged out successfully!');
                // window.location.href = '/login';
            }
        }

        // Drag and drop functionality
        const uploadArea = document.querySelector('.upload-area');
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            uploadArea.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, unhighlight, false);
        });

        function highlight(e) {
            uploadArea.classList.add('highlight');
        }

        function unhighlight(e) {
            uploadArea.classList.remove('highlight');
        }

        uploadArea.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            let dt = e.dataTransfer;
            let files = dt.files;
            selectedFiles = Array.from(files);
            displaySelectedFiles();
        }
    </script>
    <script>
        // Disable right-click
        document.addEventListener('contextmenu', function (e) {
          e.preventDefault();
        });
      
        // Disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
        document.addEventListener('keydown', function (e) {
          if (
            e.key === "F12" || 
            (e.ctrlKey && e.shiftKey && (e.key === "I" || e.key === "J")) || 
            (e.ctrlKey && e.key === "U") || 
            (e.ctrlKey && e.shiftKey && e.key === "C")
          ) {
            e.preventDefault();
          }
        });
    </script>
</body>
</html>